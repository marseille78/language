# (PHP) 13 Cookie

## Заголовки відповіді

Set-Cookie --- (Заголовки відповіді)

Вказує браузеру зберегти дані до *куків*, які сервер може використовувати при наступних запитах, наприклад, для автентифікації або збереження налаштувань користувача.



## Функції

setcookie("name", "John") --- (Функції)

*Створення тимчасової cookie*. Цей виклик надсилає браузеру інструкцію зберегти невеликий фрагмент даних — так званий "cookie", який зберігається на боці користувача. Він потрібен для того, щоб зберігати інформацію між різними запитами (наприклад, для авторизації або персоналізації).

У результаті браузер користувача отримає кукі з назвою *name* і значенням *John*.



setcookie("name", "John", time()+3600) --- (Функції)

*Створення довготривалої cookie на одну годину*. Цей виклик вказує браузеру зберегти дані у вигляді кукі — це невелика інформація, яка зберігається на боці користувача для подальшого використання на сайті. Дані будуть збережені з ім'ям *"name"* і значенням *"John"*, а також автоматично видаляться через годину.



setcookie("name", "John", time()+3600, "/docs/") --- (Функції)

*Cookie мають доступ на одну годину за шляхом /docs/*. Цей виклик інструктує браузер зберегти дані (кукі) з указаним ім'ям *"name"* і значенням *"John"*, які будуть дійсними протягом години й надсилатимуться лише при доступі до сторінок у каталозі */docs/* на сайті.



setcookie("name", "John", time()+3600, "/", ".example.com") --- (Функції)

*Cookie доступны один час по пути для всех поддоменов*. Цей виклик надсилає інструкцію браузеру зберегти дані (кукі) з вказаним ім'ям *"name"* і значенням *"John"*, які будуть дійсні протягом однієї години, доступні для всіх сторінок сайту, а також для всіх піддоменів основного домену *example.com*.



setcookie("name", "John", time()+3600, "/", ".example.com", true) --- (Функції)

*Сookie можна віддавати лише при https*. Цей виклик інструктує браузер зберегти кукі з вказаним ім'ям *"name"* і значенням *"John"*, яке буде:

- дійсне протягом 1 години,
- доступне на всіх сторінках сайту,
- поширюватися на всі піддомени основного домену *example.com*,
- і буде передаватися лише по захищених *HTTPS-з'єднаннях*.



setcookie("name", "John", time()+3600, "/", ".example.com", false, true) --- (Функції)

*Сookie можна віддавати лише при http запиті*. Цей виклик інструктує браузер зберегти кукі з вказаним ім'ям *"name"* і значенням *"John"*, яке буде:

- дійсне протягом 1 години,
- доступне на всіх сторінках сайту,
- поширюватися на всі піддомени основного домену *example.com*,
- доступне лише через HTTP-протокол, тобто його не можна буде прочитати за допомогою JavaScript.



## Конструкції

$_COOKIE["name"] --- (Конструкції)

*Читання cookie*. Конструкція використовується для отримання значення куки за вказаним ім'ям *"name"*.



setcookie("name", "John", time()-3600) --- (Конструкції)

*Видалення cookie*. Конструкція використовується для видалення куки з ім'ям *"name"* і значенням *"John"*.



$str = serialize($user);
setcookie("user", $str); --- (Конструкції)

*Серіалізація*. Конструкція серіалізує масив або об'єкт *$user* у строку *$str*, після чого зберігає її в куки з назвою *"user"*.



$user = unserialize($_COOKIE["user"]) --- (Конструкції)

*Десеріалізація*. Ця конструкція відновлює (десеріалізує) значення з куки *"user"*, яке було збережене як строка, і перетворює його назад у масив або об'єкт і зберігаємо в змінну *$user*.



$str = base64_encode(serialize($user)) --- (Конструкції)

*Зберігання цілісності*. Ця конструкція спочатку серіалізує змінну *$user* в строку, а потім кодує її в формат *base64*, щоб отримати більш компактне та безпечне представлення даних для зберігання або передачі.

Результат зберігаємо в змінну *$str*.



$user = unserialize(base64_decode($_COOKIE["user"])) --- (Конструкції)

*Зберігання цілісності*. Ця конструкція спочатку декодує значення куки *"user"* з формату *base64*, а потім розпаковує (десеріалізує) його назад у початковий формат, відновлюючи *об'єкт* або *масив*, що був серіалізований і закодований раніше.

Результат зберігаємо в змінну *$user*.



## Керування сесіями

session_start() --- (Керування сесіями. Функція)

(Створення сесії и/або доступу до неї)
Ця функція запускає сесію або відновлює існуючу сесію на основі ідентифікатора сесії. Вона повинна бути викликана перед виведенням будь-якого контенту на сторінку, оскільки використовує механізм cookie або URL для збереження ідентифікатора сесії.



$_SESSION['key'] = $val; --- (Керування сесіями. Конструкція)

(Запис до сесійної змінної)
Зберігає значення змінної *$val* у сесії під вказаним ключем *'key'*, щоб це значення можна було використовувати на інших сторінках під час того самого сеансу користувача.



echo $_SESSION['key']; --- (Керування сесіями. Конструкція)

(Отримання змісту сесійної змінної)
Виводить значення, яке зберігається в сесії під вказаним ключем *'key'*. Це значення буде доступне протягом того самого сеансу користувача.



session_destroy() --- (Керування сесіями. Функція)

(Очистка сесійних змінних)
Ця функція припиняє сесію, видаляючи всі дані, що зберігаються в ній. Після її виклику всі дані сесії стають недоступними, але сама сесія залишається активною, доки не буде завершена або знищена. Ця функція не приймає жодних аргументів.



setcookie(session_name(), session_id(), time()-3600) --- (Керування сесіями. Функція)

(Примусове видалення сесійної cookie)
Ця конструкція використовується для видалення cookie, яке містить ідентифікатор сесії. Вона встановлює значення cookie, використовуючи поточне ім'я сесії, але з часом, що минув на 1 годину назад (за допомогою *time() - 3600*). Це змушує браузер видалити cookie, тим самим завершуючи сесію для поточного користувача.



session_name() --- (Керування сесіями. Функція)

Ця функція повертає або дозволяє встановити ім'я cookie, яке використовується для ідентифікації сесії. Якщо її викликати без аргументів, вона просто повертає поточне ім'я сесії. Якщо передати аргумент, то це ім'я буде встановлено як нове ім'я для cookie сесії.

- *без аргументів* — повертає поточне ім'я сесії.
- *з аргументом* — встановлює нове ім'я для сесії.



session_id() --- (Керування сесіями. Функція)

Ця функція повертає або дозволяє встановити ідентифікатор поточної сесії. Якщо викликати її без аргументів, вона повертає поточний ідентифікатор сесії. Якщо передати аргумент, то вона встановлює новий ідентифікатор сесії.

- *без аргументів* — повертає поточний ідентифікатор сесії.
- *з аргументом* — встановлює новий ідентифікатор для сесії.



## Додаткові параметри сесії

ini_set('key', 'val') --- (Додаткові параметри сесії. Функція)

Ця конструкція дозволяє змінювати налаштування конфігурації PHP під час виконання скрипту. Вона використовує пару "ключ-значення", де "ключ" є параметром конфігурації, а "значення" — значенням, яке буде застосовано для цього параметра.

*Аргументи:*

- *'key'*: це параметр конфігурації, який ви хочете змінити (наприклад, *'display_errors'*, *'max_execution_time'* тощо).
- *'val'*: це нове значення для параметра конфігурації, яке буде застосовано (наприклад, *'On'*, *'60'*, тощо).



session.name --- (Додаткові параметри сесії)

Це параметр конфігурації, який визначає ім'я для сесійного ідентифікатора, що буде використовуватися під час збереження та відновлення сесії. Це ім'я зазвичай асоціюється з унікальним ідентифікатором, що дозволяє серверу ідентифікувати конкретну сесію користувача на протязі сеансу взаємодії. За замовчуванням, для PHP це значення зазвичай є "PHPSESSID".

Цей параметр може бути змінений, якщо потрібно використовувати інше ім'я для сесійного ідентифікатора.



session.auto_start --- (Додаткові параметри сесії)

Це параметр конфігурації, який визначає, чи має сервер автоматично запускати сесію при кожному запиті. Якщо цей параметр увімкнений, то сесія ініціалізується автоматично, і користувач може одразу використовувати сесійні дані без необхідності викликати спеціальну функцію для початку сесії.

За замовчуванням цей параметр зазвичай вимкнений, і сесія запускається лише після виклику функції для ініціалізації сесії.



session.save_path --- (Додаткові параметри сесії)

Це параметр конфігурації, який вказує шлях до каталогу, де зберігаються файли сесій. Встановлення цього параметра дозволяє визначити, де саме сервер буде зберігати дані сесій, зокрема файли, які містять ідентифікатори сесій та відповідні значення.

Цей параметр може бути корисний для зміни місця зберігання сесійних даних, наприклад, якщо потрібно зберігати їх на окремому диску або в іншому каталозі для підвищення безпеки або ефективності.



session.gc_maxlifetime --- (Додаткові параметри сесії)

Це параметр конфігурації, який визначає максимальний час (в секундах), протягом якого зберігаються дані сесії, якщо користувач не здійснював жодної активності. Після цього часу система автоматично видаляє сесії, що не були активні, з метою очищення та звільнення ресурсів.

Цей параметр допомагає встановити період, після якого неактивні сесії більше не зберігаються на сервері, що дозволяє зменшити навантаження та підвищити безпеку.



session.cookie_lifetime --- (Додаткові параметри сесії)

Цей параметр визначає, скільки часу файл cookie, який зберігає ідентифікатор сеансу, залишатиметься дійсним у браузері користувача після його встановлення. Якщо встановлено значення 0, cookie буде знищено після закриття браузера.



session.cookie_httponly --- (Додаткові параметри сесії)

Цей параметр вказує, що cookie, який зберігає ідентифікатор сеансу, буде доступний лише через HTTP-протокол і не може бути прочитаний або змінений через JavaScript, що підвищує безпеку сесії.



session.cookie_path --- (Додаткові параметри сесії)

Цей параметр вказує, яка частина вебсайту (шлях у URL) може використовувати cookie сесії: браузер надсилатиме файл cookie лише для сторінок, що починаються з цього шляху.